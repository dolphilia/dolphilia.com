# 拡張機能の概要

Visual Studio Codeは、その機能を拡張するための拡張機能を数多く提供しています。時には、適切なコントリビューションポイントと VS Code API を見つけるのが難しい場合があります。このトピックでは、拡張機能をいくつかのカテゴリに分割します。各カテゴリでは、次のことを説明します。

- 拡張機能が使用できるいくつかの機能
- これらの機能を使用するための、より詳細なトピックへのリンク
- 拡張機能のアイデア

しかし、VS Codeの安定性とパフォーマンスを確保するために、拡張機能には制限を課しています。例えば、拡張機能はVS Code UIのDOMにアクセスすることができません。

## 共通機能

Common Capabilities は、どの拡張機能でも使用できる中核的な機能の一部です。

これらの機能には、以下のようなものがあります。

- コマンド、設定、キーバインディング、またはコンテキストメニュー項目の登録
- ワークスペースまたはグローバルデータの保存
- 通知メッセージの表示
- クイックピックを使用してユーザーの入力を収集する。
- システムファイルピッカーを開き、ユーザーがファイルやフォルダを選択できるようにする。
- Progress API を使用して、長時間実行されている操作を表示する。

## テーミング

テーミングは、VS Codeの外観、エディタ内のソースコードの色、VS Code UIの色の両方を制御します。VS Codeを異なる色合いの緑にしてマトリックスのコードを書いているように見せたり、究極の最小限のグレースケールのワークスペースを作りたい場合は、テーマが適しています。

拡張機能のアイデア

- ソースコードの色を変更する。
- VS CodeのUIの色を変える。
- 既存のTextMateのテーマをVS Codeに移植。
- カスタムファイルアイコンを追加

## 宣言型言語の特徴

宣言型言語機能は、ブラケットマッチング、自動インデント、シンタックスハイライトなど、プログラミング言語の基本的なテキスト編集をサポートします。これは、コードを書くことなく、宣言的に実行されます。インテリセンスやデバッグなど、より高度な言語機能については、プログラム言語機能を参照してください。

拡張機能のアイデア

- 一般的な JavaScript のスニペットを拡張機能にまとめます。
- VS Code に新しいプログラミング言語について知らせる。
- プログラミング言語の文法を追加したり置き換えたりする。
- 既存の文法を文法インジェクションで拡張する
- 既存のTextMateの文法をVS Codeに移植する

## プログラム言語の特徴

プログラム言語機能は、Hover、Go to Definition、診断エラー、IntelliSense、CodeLensなど、豊富なプログラミング言語サポートを追加します。これらの言語機能は、vscode.languages.* APIを通じて公開されます。拡張機能は、これらのAPIを直接使用するか、言語サーバを書き、VS Code Language Server libraryを使用してVS Codeに適合させることができます。

言語機能のリストとその使用目的を提供していますが、これらのAPIを創造的に使用することを妨げるものは何もありません。例えば、CodeLensやHoversはインラインで追加情報を表示するのに最適な方法ですし、診断エラーはスペルやコードスタイルのエラーを強調するために使用することができます。

拡張機能のアイデア

- API のサンプル使用法を示す hovers を追加する。
- 診断機能を使って、ソースコードのスペルミスやリンターエラーを報告する。
- HTML用の新しいコードフォーマッターを登録する
- リッチでコンテキストを意識したインテリセンスを提供する
- 言語の折りたたみ、ブレッドクラム、アウトラインのサポート追加

## ワークベンチ・エクステンション

Workbench ExtensionsはVS Code WorkbenchのUIを拡張します。ファイルエクスプローラに新しい右クリックアクションを追加したり、VS CodeのTreeView APIを使ってカスタムエクスプローラを構築したりすることができます。また、拡張機能が完全にカスタマイズされたユーザインタフェースを必要とする場合、Webview APIを使用して、標準のHTML、CSS、JavaScriptを使用して独自のドキュメントプレビューやUIを構築することができます。

拡張機能のアイデア

- ファイルエクスプローラにカスタムコンテキストメニューアクションを追加する。
- サイドバーに新しいインタラクティブな TreeView を作成。
- アクティビティバーの新しいビューを定義
- ステータス バーに新しい情報を表示する。
- WebView API を使用したカスタム コンテンツのレンダリング
- ソースコントロールプロバイダの寄贈

## デバッギング

VS CodeのデバッグUIを特定のデバッガやランタイムに接続するDebugger Extensionsを書くことで、VS Codeのデバッグ機能を利用することができます。

拡張機能のアイデア

- Debug Adapter の実装を提供することで、VS Code のデバッグ UI をデバッガまたはランタイムに接続します。
- デバッガー拡張機能でサポートする言語を指定します。
- デバッガが使用するデバッグ構成属性の豊富なインテリセンスとホバー情報を提供する。
- デバッグ設定のスニペットを提供する。

一方、VS Code では、デバッグ関連の機能を任意の VS Code デバッガ上に実装し、ユーザーのデバッグ体験を自動化するための Debug Extension API も提供しています。

拡張機能のアイデア

動的に作成されるデバッグ設定に基づいて、デバッグセッションを開始します。
デバッグセッションのライフサイクルの追跡
プログラムによるブレークポイントの作成と管理

## UXガイドライン

拡張機能をVS Codeのユーザーインターフェイスにスムーズに適合させるために、UXガイドラインを参照してください。ここでは、拡張機能のUIを作成するためのベストプラクティスと、望ましいVS Codeワークフローに従うための規約を学びます。

## 制限事項

拡張機能には、いくつかの制限があります。ここでは、その制限事項とその目的について説明します。

### DOMアクセス不可

拡張機能は、VS Code UI の DOM にアクセスすることはできません。VS CodeにカスタムCSSを適用したり、VS Code UIにHTML要素を追加するような拡張機能を記述することはできません。

VS Codeでは、常に利用可能で応答性の高いエディタを提供するために、基礎となるWeb技術の使用を最適化するよう継続的に努力しており、これらの技術や製品の進化に合わせてDOMの使用を調整し続けていきます。拡張機能がVS Codeの安定性と性能を妨げないように、また、既存の拡張機能を壊すことなくVS CodeのDOMを改善し続けるために、拡張機能をExtension Hostプロセスで実行し、DOMに直接アクセスできないようにします。
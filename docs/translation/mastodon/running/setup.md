# 新しいインスタンスのセットアップ

Mastodonインストール後に行うこと

[[TOC]]

## 管理者アカウントの作成

### ブラウザで

ブラウザでサインアップした後、コマンドラインを使用して新しく作成したアカウントに管理者権限を与える必要があります。あなたのユーザー名が `alice` であると仮定して。

```bash
RAILS_ENV=production bin/tootctl accounts modify alice --role Owner
```

::: warning

Mastodon 4.0 以前では、ロールは `user`, `moderator`, `admin` のいずれかであるとハードコードされていた。Mastodon 4.0 以降では、ロールシステムをカスタマイズできるようになった。デフォルトのロールは `Moderator`, `Admin`, `Owner` である。カスタムロールの名前は大文字と小文字が区別される。

:::

### コマンドラインから

コマンドラインインターフェイスを使用して、新しいアカウントを作成することができます。

```bash
RAILS_ENV=production bin/tootctl accounts create \
  alice \
  --email alice@example.com \
  --confirmed \
  --role Owner
```

ランダムに生成されたパスワードが端末に表示されます。

## サーバー情報の入力

ログイン後、**サイト設定**ページ（**設定** -> **管理**）に移動します。この情報を記入することに技術的な要件はありませんが、人間用のサーバーを運用する上で重要であると考えられています。

|        Setting         |                                                    Meaning                                                     |
| :--------------------- | :------------------------------------------------------------------------------------------------------------- |
| お問い合わせユーザー名 | ユーザー名（誰がサーバーを所有しているかが分かるように                                                         |
| ビジネスメール         | アカウントからロックアウトされた人、またはアカウントを持たない人が連絡できるようにするための電子メールアドレス |
| インスタンスの説明     | なぜこのサーバーを立ち上げたのですか？誰のためのものですか？何が違うのでしょうか？                             |
| カスタム拡張情報       | ここにいろいろな情報を入れることができますが、**行動規範**を推奨します。                                       |

入力後、「変更を保存する」をクリックします。

## 定期的なクリーンアップタスクの実行

Mastodonは一時ファイルを生成するので、一定時間が経過するとクリーンアップする価値があります（例：ホスティングの費用を節約するため）。一般的には、これらの定期的なクリーンアップ作業を実行するために `cron` ジョブ（または別のメカニズム）をセットアップすることをお勧めします。

通常、[`tootctl media remove`](https://docs.joinmastodon.org/admin/tootctl/#media) と [`tootctl preview_cards remove`](https://docs.joinmastodon.org/admin/tootctl/#preview_cards) を定期的に実行したいものです。これらはリモートメディア(画像、ビデオ、オーディオなど)とプレビューカード(リンク用プレビュー画像など)を一定の日数が経過した後にクリーンアップします。(クリーンアップするまでの期間を調整したい場合は、これらのコマンドのドキュメントを確認してください)。

まず、`crontab -e` を実行して、`mastodon` ユーザの cronfile を編集してください。(どのエディタを使うか聞かれたら、好きなエディタを選んでください)。

次に、ファイルの一番下に、以下のようなものを追加します。

```
@weekly RAILS_ENV=production /home/mastodon/live/bin/tootctl media remove
@weekly RAILS_ENV=production /home/mastodon/live/bin/tootctl preview_cards remove
```

これにより、この2つのコマンドが週単位で実行されます。

最後に、ファイルを保存します。設定を確認するには、`crontab -l` を使用します。